---
title: "Tarea 1"
author: "Pedro Montenegro"
date: "13/9/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r message=FALSE, warning=FALSE}
library(sf)
library(sp)
library(spData)
library(tidyverse)
library(tmap)
library(mapview)
library(ggplot2)
library(ggspatial)
library(ggmap)
library(classInt)
library(spacetime)
library(spplot)
```

```{r include=FALSE}
africa = world %>% 
  filter(continent == "Africa", !is.na(iso_a2)) %>% 
  left_join(worldbank_df, by = "iso_a2") %>% 
  select(name, subregion, gdpPercap, HDI, pop_growth) %>% 
  st_transform("+proj=aea +lat_1=20 +lat_2=-23 +lat_0=0 +lon_0=25")
```

```{r}
africa %>% 
  ggplot() +
  geom_sf(aes(geometry= geom, fill= HDI)) +  
  scale_fill_viridis_c(guide = guide_legend(title = "HDI")) +
  theme_minimal() + 
  ggtitle("Distribución del Índice de Desarrollo Humano",
         subtitle= "Africa")
```
```{r}
tmap_mode("view") 

tm_shape(africa)+
tm_polygons("HDI")

tmap_mode("plot")

```



```{r}
ph_basemap <- get_map(location=c(lon = -75.16522, lat = 39.95258), zoom=11, maptype = 'terrain-background', source = 'stamen')

```

```{r}
data(air, package = "spacetime")
head(air)
class(air)

nds = DE_NUTS1["Niedersachsen",]
class(nds)
class(africa)

africa_sp <- as(africa$geom, 'Spatial')

class(africa_sp)

bgMap = get_map(bbox(africa_sp), source = "google", zoom = 7)



ggmap_africa <- get_map("africa", maptype = "satellite", zoom = 6, source = "google")

par(mar = rep(0,4))
merc = CRS("+init=epsg:3857")
plot(spTransform(nds, merc), bgMap = bgMap, col = grey(.5, alpha = .5))
```

```{r}
library(mapview)

```

```{r}
tmap_mode("plot")

tm1 <- tm_shape(london_boroughs_27700) + tm_polygons("count", convert2density = TRUE)
tm2 <- tm_shape(london_boroughs_27700) + tm_bubbles(size = "count")

tmap_arrange(tm1, tm2)
```

```{r}
tmap_mode("view")
tm_basemap("Stamen.Watercolor") +
tm_shape(africa) + tm_polygons("HDI", convert2density = TRUE) + tm_bubbles(size = "HDI", col = "red") +
tm_tiles("Stamen.TonerLabels")
```

```{r}
tmap_mode("plot")

tm_shape(london_boroughs_27700) + 
  tm_polygons("count", convert2density = TRUE) +
  tm_bubbles(size = "count", col = "red") +
  tm_scale_bar(position=c("left", "bottom")) +
  tm_compass(size = 2, position=c("right", "top"))
```



```{r}
tm_africa <- tm_shape(africa) +
tm_polygons("HDI", 
          palette = "RdYlBu")
```

```{r}
m = mapview::mapview(africa)
m@map
```

Create a map showing the geographic distribution of the Human Development Index (HDI) across Africa with:

base graphics (hint: use plot()) and
tmap (hint: use tm_shape(africa) + ...).
Name two advantages of each approach
Bonus: name 2 other packages could be used to show the same data?

# Siga esta presentación y haga el ejercicio de la pag 16
# https://geocompr.github.io/presentations/04_viz.html#1
# Las preguntas que debe responder son las siguientes:
 
# Cree un mapa que muestre la distribución geográfica de el Human Development Index (HDI) en el continente africano, esto usando:

# (1) base graphics (hint: use plot()) 
# (2) tmap (hint: use tm_shape(africa) + ...).
# 
# Edite los gráficos con un título, una descripción, fuente y todos los detalles que considere necesarios.
# Ahora, escriba dos ventajas de cada opción.

## Código sugerido: 
  
library(sf)
library(spData)
library(tidyverse)
install.packages('spDataLarge',repos='https://nowosad.github.io/drat/',type='source')

africa = world %>% 
  filter(continent == "Africa", !is.na(iso_a2)) %>%
  left_join(worldbank_df, by = "iso_a2") %>% 
  select(name, subregion, gdpPercap, HDI, pop_growth) %>% 
  st_transform("+proj=aea +lat_1=20 +lat_2=-23 +lat_0=0 +lon_0=25")

plot(africa[,"HDI"])

library(tmap)
tm_shape(africa) + tm_polygons("HDI", palette = "RdYlBu")
