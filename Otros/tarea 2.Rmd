---
title: "Tarea 2"
author: "Pedro Montenegro"
date: "13/9/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r message=FALSE, warning=FALSE}
library(sf)
library(sp)
library(spData)
library(tidyverse)
library(tmap)
library(mapview)
library(ggplot2)
library(ggspatial)
library(ggmap)
library(classInt)
library(spacetime)
library(cartography)
library(raster)
#library(spDataLarge)
library(leaflet)
```

# Información World selección África

```{r include=FALSE}
world %>% st_drop_geometry() %>% 
  group_by(continent) %>% count()

africa <- world %>% 
  filter(continent == "Africa", !is.na(iso_a2)) %>% 
  left_join(worldbank_df, by = "iso_a2") %>% 
  select(name, subregion, gdpPercap, HDI, pop_growth) %>% 
  st_transform("+proj=aea +lat_1=20 +lat_2=-23 +lat_0=0 +lon_0=25")

africa_sp <- as(africa$geom, 'Spatial')
#class(africa_sp)

```

# Gráfico  sf

```{r}
africa %>% 
  ggplot() +
  geom_sf(aes(geometry= geom, fill= HDI)) +  
  scale_fill_viridis_c(guide = guide_legend(title = "HDI")) +
  theme_minimal() + 
  ggtitle("Distribución del Índice de Desarrollo Humano",
         subtitle= "Africa")
```

# Gráfico con tmap interactivo

```{r message=FALSE, warning=FALSE}
tmap_mode("view") 

tm_shape(africa)+
tm_polygons("HDI")

tmap_mode("plot")
```

```{r}
tmap_mode("view")
tm_basemap("Stamen.Watercolor") +
tm_shape(africa) + tm_polygons("HDI", convert2density = TRUE) + tm_bubbles(size = "HDI", col = "red") +
tm_tiles("Stamen.TonerLabels")
```

# Mapview interactivo

```{r}
m = mapview::mapview(africa)
m@map
```

# Gráfico tmap regular

```{r}
tmap_mode("plot")

tm_shape(africa) + tm_polygons("HDI", convert2density = TRUE)+
  tm_bubbles(size = "HDI") +
  tm_scale_bar(position=c("right", "top")) +
  tm_compass(size = 2, position=c("right", "top"))
```

```{r}
tm_shape(africa) +
tm_polygons("HDI", 
          palette = "RdYlBu")+
  tm_scale_bar(position=c("right", "top")) +
  tm_compass(size = 2, position=c("right", "top"))
```

# Gráfico con Cartography

```{r}
plot(st_geometry(africa), col="darkseagreen3", border="darkseagreen4",  
     bg = "lightblue1", lwd = 0.5)

propSymbolsChoroLayer(
  x = africa, 
  var = "HDI", 
  inches = 0.1,
  border = "grey50",
  lwd = 1,
  legend.var.pos = "África", 
  legend.var.title.txt = "Índice Desarrollo Humano",
  var2 = "HDI",
  method = "equal", 
  nclass = 6, 
  col = carto.pal(pal1 = "sand.pal", n1 = 6),
  #legend.var2.values.rnd = -2,
  legend.var2.pos = "left", 
  legend.var2.title.txt = "HDI"
) 

# layout
layoutLayer(title="Índice de Desarrollo Humano África", 
            scale = 5, tabtitle = TRUE, frame = FALSE)
# north arrow
north(pos = "topleft")
```

# Gráfico con ggmap google

```{r}
Country <- "africa"
gc <- geocode('africa')
center <- as.numeric(gc) 

 africamap = ggmap(get_googlemap(center= center, zoom=3),extent="normal")
# plot(africamap)

Get_Map_africa <-
  get_map(
      location = center
    , zoom = 3
    , maptype = "roadmap"
    , messaging = FALSE
    , urlonly = FALSE
    , filename = "ggmapTemp"
    , crop = TRUE
    , color = "color"
    , source = "google"
    )
plot(Get_Map_africa)
class(Get_Map_africa)
```
